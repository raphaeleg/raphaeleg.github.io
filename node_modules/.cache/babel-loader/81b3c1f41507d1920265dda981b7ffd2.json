{"ast":null,"code":"import _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport { useRef, useMemo, useLayoutEffect } from 'react';\nimport { extend, useThree, useFrame } from '@react-three/fiber';\nimport { MeshBVHUniformStruct, MeshBVH, SAH } from 'three-mesh-bvh';\nimport { MeshRefractionMaterial as MeshRefractionMaterial$1 } from '../materials/MeshRefractionMaterial.js';\n\nconst isCubeTexture = def => def && def.isCubeTexture;\n\nfunction MeshRefractionMaterial(_ref2) {\n  let {\n    aberrationStrength = 0,\n    fastChroma = true,\n    envMap,\n    ...props\n  } = _ref2;\n  extend({\n    MeshRefractionMaterial: MeshRefractionMaterial$1\n  });\n  const material = useRef();\n  const {\n    size\n  } = useThree();\n  const defines = useMemo(() => {\n    var _ref, _envMap$image$;\n\n    const temp = {}; // Sampler2D and SamplerCube need different defines\n\n    const isCubeMap = isCubeTexture(envMap);\n    const w = (_ref = isCubeMap ? (_envMap$image$ = envMap.image[0]) == null ? void 0 : _envMap$image$.width : envMap.image.width) !== null && _ref !== void 0 ? _ref : 1024;\n    const cubeSize = w / 4;\n\n    const _lodMax = Math.floor(Math.log2(cubeSize));\n\n    const _cubeSize = Math.pow(2, _lodMax);\n\n    const width = 3 * Math.max(_cubeSize, 16 * 7);\n    const height = 4 * _cubeSize;\n    if (isCubeMap) temp.ENVMAP_TYPE_CUBEM = '';\n    temp.CUBEUV_TEXEL_WIDTH = `${1.0 / width}`;\n    temp.CUBEUV_TEXEL_HEIGHT = `${1.0 / height}`;\n    temp.CUBEUV_MAX_MIP = `${_lodMax}.0`; // Add defines from chromatic aberration\n\n    if (aberrationStrength > 0) temp.CHROMATIC_ABERRATIONS = '';\n    if (fastChroma) temp.FAST_CHROMA = '';\n    return temp;\n  }, [aberrationStrength, fastChroma]);\n  useLayoutEffect(() => {\n    var _material$current, _material$current$__r, _material$current$__r2; // Get the geometry of this materials parent\n\n\n    const geometry = (_material$current = material.current) == null ? void 0 : (_material$current$__r = _material$current.__r3f) == null ? void 0 : (_material$current$__r2 = _material$current$__r.parent) == null ? void 0 : _material$current$__r2.geometry; // Update the BVH\n\n    if (geometry) {\n      material.current.bvh = new MeshBVHUniformStruct();\n      material.current.bvh.updateFrom(new MeshBVH(geometry.clone().toNonIndexed(), {\n        lazyGeneration: false,\n        strategy: SAH\n      }));\n    }\n  }, []);\n  useFrame(_ref3 => {\n    let {\n      camera\n    } = _ref3;\n    material.current.viewMatrixInverse = camera.matrixWorld;\n    material.current.projectionMatrixInverse = camera.projectionMatrixInverse;\n  });\n  return /*#__PURE__*/React.createElement(\"meshRefractionMaterial\", _extends({\n    // @ts-ignore\n    key: JSON.stringify(defines) // @ts-ignore\n    ,\n    defines: defines,\n    ref: material,\n    resolution: [size.width, size.height],\n    aberrationStrength: aberrationStrength,\n    envMap: envMap\n  }, props));\n}\n\nexport { MeshRefractionMaterial };","map":{"version":3,"names":["_extends","React","useRef","useMemo","useLayoutEffect","extend","useThree","useFrame","MeshBVHUniformStruct","MeshBVH","SAH","MeshRefractionMaterial","MeshRefractionMaterial$1","isCubeTexture","def","aberrationStrength","fastChroma","envMap","props","material","size","defines","_ref","_envMap$image$","temp","isCubeMap","w","image","width","cubeSize","_lodMax","Math","floor","log2","_cubeSize","pow","max","height","ENVMAP_TYPE_CUBEM","CUBEUV_TEXEL_WIDTH","CUBEUV_TEXEL_HEIGHT","CUBEUV_MAX_MIP","CHROMATIC_ABERRATIONS","FAST_CHROMA","_material$current","_material$current$__r","_material$current$__r2","geometry","current","__r3f","parent","bvh","updateFrom","clone","toNonIndexed","lazyGeneration","strategy","camera","viewMatrixInverse","matrixWorld","projectionMatrixInverse","createElement","key","JSON","stringify","ref","resolution"],"sources":["/Users/crushedsummers/Desktop/Work/Application/portfolio22/node_modules/@react-three/drei/core/MeshRefractionMaterial.js"],"sourcesContent":["import _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport { useRef, useMemo, useLayoutEffect } from 'react';\nimport { extend, useThree, useFrame } from '@react-three/fiber';\nimport { MeshBVHUniformStruct, MeshBVH, SAH } from 'three-mesh-bvh';\nimport { MeshRefractionMaterial as MeshRefractionMaterial$1 } from '../materials/MeshRefractionMaterial.js';\n\nconst isCubeTexture = def => def && def.isCubeTexture;\n\nfunction MeshRefractionMaterial({\n  aberrationStrength = 0,\n  fastChroma = true,\n  envMap,\n  ...props\n}) {\n  extend({\n    MeshRefractionMaterial: MeshRefractionMaterial$1\n  });\n  const material = useRef();\n  const {\n    size\n  } = useThree();\n  const defines = useMemo(() => {\n    var _ref, _envMap$image$;\n\n    const temp = {}; // Sampler2D and SamplerCube need different defines\n\n    const isCubeMap = isCubeTexture(envMap);\n    const w = (_ref = isCubeMap ? (_envMap$image$ = envMap.image[0]) == null ? void 0 : _envMap$image$.width : envMap.image.width) !== null && _ref !== void 0 ? _ref : 1024;\n    const cubeSize = w / 4;\n\n    const _lodMax = Math.floor(Math.log2(cubeSize));\n\n    const _cubeSize = Math.pow(2, _lodMax);\n\n    const width = 3 * Math.max(_cubeSize, 16 * 7);\n    const height = 4 * _cubeSize;\n    if (isCubeMap) temp.ENVMAP_TYPE_CUBEM = '';\n    temp.CUBEUV_TEXEL_WIDTH = `${1.0 / width}`;\n    temp.CUBEUV_TEXEL_HEIGHT = `${1.0 / height}`;\n    temp.CUBEUV_MAX_MIP = `${_lodMax}.0`; // Add defines from chromatic aberration\n\n    if (aberrationStrength > 0) temp.CHROMATIC_ABERRATIONS = '';\n    if (fastChroma) temp.FAST_CHROMA = '';\n    return temp;\n  }, [aberrationStrength, fastChroma]);\n  useLayoutEffect(() => {\n    var _material$current, _material$current$__r, _material$current$__r2;\n\n    // Get the geometry of this materials parent\n    const geometry = (_material$current = material.current) == null ? void 0 : (_material$current$__r = _material$current.__r3f) == null ? void 0 : (_material$current$__r2 = _material$current$__r.parent) == null ? void 0 : _material$current$__r2.geometry; // Update the BVH\n\n    if (geometry) {\n      material.current.bvh = new MeshBVHUniformStruct();\n      material.current.bvh.updateFrom(new MeshBVH(geometry.clone().toNonIndexed(), {\n        lazyGeneration: false,\n        strategy: SAH\n      }));\n    }\n  }, []);\n  useFrame(({\n    camera\n  }) => {\n    material.current.viewMatrixInverse = camera.matrixWorld;\n    material.current.projectionMatrixInverse = camera.projectionMatrixInverse;\n  });\n  return /*#__PURE__*/React.createElement(\"meshRefractionMaterial\", _extends({\n    // @ts-ignore\n    key: JSON.stringify(defines) // @ts-ignore\n    ,\n    defines: defines,\n    ref: material,\n    resolution: [size.width, size.height],\n    aberrationStrength: aberrationStrength,\n    envMap: envMap\n  }, props));\n}\n\nexport { MeshRefractionMaterial };\n"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,oCAArB;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,SAASC,MAAT,EAAiBC,OAAjB,EAA0BC,eAA1B,QAAiD,OAAjD;AACA,SAASC,MAAT,EAAiBC,QAAjB,EAA2BC,QAA3B,QAA2C,oBAA3C;AACA,SAASC,oBAAT,EAA+BC,OAA/B,EAAwCC,GAAxC,QAAmD,gBAAnD;AACA,SAASC,sBAAsB,IAAIC,wBAAnC,QAAmE,wCAAnE;;AAEA,MAAMC,aAAa,GAAGC,GAAG,IAAIA,GAAG,IAAIA,GAAG,CAACD,aAAxC;;AAEA,SAASF,sBAAT,QAKG;EAAA,IAL6B;IAC9BI,kBAAkB,GAAG,CADS;IAE9BC,UAAU,GAAG,IAFiB;IAG9BC,MAH8B;IAI9B,GAAGC;EAJ2B,CAK7B;EACDb,MAAM,CAAC;IACLM,sBAAsB,EAAEC;EADnB,CAAD,CAAN;EAGA,MAAMO,QAAQ,GAAGjB,MAAM,EAAvB;EACA,MAAM;IACJkB;EADI,IAEFd,QAAQ,EAFZ;EAGA,MAAMe,OAAO,GAAGlB,OAAO,CAAC,MAAM;IAC5B,IAAImB,IAAJ,EAAUC,cAAV;;IAEA,MAAMC,IAAI,GAAG,EAAb,CAH4B,CAGX;;IAEjB,MAAMC,SAAS,GAAGZ,aAAa,CAACI,MAAD,CAA/B;IACA,MAAMS,CAAC,GAAG,CAACJ,IAAI,GAAGG,SAAS,GAAG,CAACF,cAAc,GAAGN,MAAM,CAACU,KAAP,CAAa,CAAb,CAAlB,KAAsC,IAAtC,GAA6C,KAAK,CAAlD,GAAsDJ,cAAc,CAACK,KAAxE,GAAgFX,MAAM,CAACU,KAAP,CAAaC,KAA9G,MAAyH,IAAzH,IAAiIN,IAAI,KAAK,KAAK,CAA/I,GAAmJA,IAAnJ,GAA0J,IAApK;IACA,MAAMO,QAAQ,GAAGH,CAAC,GAAG,CAArB;;IAEA,MAAMI,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,IAAL,CAAUJ,QAAV,CAAX,CAAhB;;IAEA,MAAMK,SAAS,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAT,EAAYL,OAAZ,CAAlB;;IAEA,MAAMF,KAAK,GAAG,IAAIG,IAAI,CAACK,GAAL,CAASF,SAAT,EAAoB,KAAK,CAAzB,CAAlB;IACA,MAAMG,MAAM,GAAG,IAAIH,SAAnB;IACA,IAAIT,SAAJ,EAAeD,IAAI,CAACc,iBAAL,GAAyB,EAAzB;IACfd,IAAI,CAACe,kBAAL,GAA2B,GAAE,MAAMX,KAAM,EAAzC;IACAJ,IAAI,CAACgB,mBAAL,GAA4B,GAAE,MAAMH,MAAO,EAA3C;IACAb,IAAI,CAACiB,cAAL,GAAuB,GAAEX,OAAQ,IAAjC,CAlB4B,CAkBU;;IAEtC,IAAIf,kBAAkB,GAAG,CAAzB,EAA4BS,IAAI,CAACkB,qBAAL,GAA6B,EAA7B;IAC5B,IAAI1B,UAAJ,EAAgBQ,IAAI,CAACmB,WAAL,GAAmB,EAAnB;IAChB,OAAOnB,IAAP;EACD,CAvBsB,EAuBpB,CAACT,kBAAD,EAAqBC,UAArB,CAvBoB,CAAvB;EAwBAZ,eAAe,CAAC,MAAM;IACpB,IAAIwC,iBAAJ,EAAuBC,qBAAvB,EAA8CC,sBAA9C,CADoB,CAGpB;;;IACA,MAAMC,QAAQ,GAAG,CAACH,iBAAiB,GAAGzB,QAAQ,CAAC6B,OAA9B,KAA0C,IAA1C,GAAiD,KAAK,CAAtD,GAA0D,CAACH,qBAAqB,GAAGD,iBAAiB,CAACK,KAA3C,KAAqD,IAArD,GAA4D,KAAK,CAAjE,GAAqE,CAACH,sBAAsB,GAAGD,qBAAqB,CAACK,MAAhD,KAA2D,IAA3D,GAAkE,KAAK,CAAvE,GAA2EJ,sBAAsB,CAACC,QAAlP,CAJoB,CAIwO;;IAE5P,IAAIA,QAAJ,EAAc;MACZ5B,QAAQ,CAAC6B,OAAT,CAAiBG,GAAjB,GAAuB,IAAI3C,oBAAJ,EAAvB;MACAW,QAAQ,CAAC6B,OAAT,CAAiBG,GAAjB,CAAqBC,UAArB,CAAgC,IAAI3C,OAAJ,CAAYsC,QAAQ,CAACM,KAAT,GAAiBC,YAAjB,EAAZ,EAA6C;QAC3EC,cAAc,EAAE,KAD2D;QAE3EC,QAAQ,EAAE9C;MAFiE,CAA7C,CAAhC;IAID;EACF,CAbc,EAaZ,EAbY,CAAf;EAcAH,QAAQ,CAAC,SAEH;IAAA,IAFI;MACRkD;IADQ,CAEJ;IACJtC,QAAQ,CAAC6B,OAAT,CAAiBU,iBAAjB,GAAqCD,MAAM,CAACE,WAA5C;IACAxC,QAAQ,CAAC6B,OAAT,CAAiBY,uBAAjB,GAA2CH,MAAM,CAACG,uBAAlD;EACD,CALO,CAAR;EAMA,OAAO,aAAa3D,KAAK,CAAC4D,aAAN,CAAoB,wBAApB,EAA8C7D,QAAQ,CAAC;IACzE;IACA8D,GAAG,EAAEC,IAAI,CAACC,SAAL,CAAe3C,OAAf,CAFoE,CAE5C;IAF4C;IAIzEA,OAAO,EAAEA,OAJgE;IAKzE4C,GAAG,EAAE9C,QALoE;IAMzE+C,UAAU,EAAE,CAAC9C,IAAI,CAACQ,KAAN,EAAaR,IAAI,CAACiB,MAAlB,CAN6D;IAOzEtB,kBAAkB,EAAEA,kBAPqD;IAQzEE,MAAM,EAAEA;EARiE,CAAD,EASvEC,KATuE,CAAtD,CAApB;AAUD;;AAED,SAASP,sBAAT"},"metadata":{},"sourceType":"module"}